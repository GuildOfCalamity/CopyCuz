<Application
    x:Class="CopyCuz.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ctrl="clr-namespace:CopyCuz.Controls"
    xmlns:local="clr-namespace:CopyCuz"
    DispatcherUnhandledException="Application_DispatcherUnhandledException"
    StartupUri="MainWindow.xaml">
    <Application.Resources>
        <ResourceDictionary>

            <local:StringToBrushConverter x:Key="stringToBrush" />
            <local:BoolToVisibilityConverter x:Key="boolToVisibility" />

            <!--#region [Colors and Brushes]-->
            <Color x:Key="GlowLight">#70C0FF</Color>
            <SolidColorBrush x:Key="LightBrush" Color="{StaticResource GlowLight}" />
            <Color x:Key="Primary">#0BC</Color>
            <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource Primary}" />
            <Color x:Key="Secondary">#002F50</Color>
            <SolidColorBrush x:Key="SecondaryBrush" Color="{StaticResource Secondary}" />
            <Color x:Key="Outline">#B0B0B0</Color>
            <SolidColorBrush x:Key="OutlineBrush" Color="{StaticResource Outline}" />
            <Color x:Key="BackgroundDark">#FF101012</Color>
            <SolidColorBrush x:Key="BackgroundDarkBrush" Color="{StaticResource BackgroundDark}" />
            <Color x:Key="BackgroundLight">#FF999999</Color>
            <SolidColorBrush x:Key="BackgroundLightBrush" Color="{StaticResource BackgroundLight}" />
            <SolidColorBrush x:Key="DisabledBackgroundBrush" Color="#CCC" />
            <SolidColorBrush x:Key="DisabledBackgroundBrush2" Color="#333" />
            <SolidColorBrush x:Key="DisabledBorderBrush" Color="#AAA" />
            <SolidColorBrush x:Key="DisabledForegroundBrush" Color="#888" />
            <Color x:Key="WindowColor">#FFE8EDF9</Color>
            <Color x:Key="ContentAreaColorLight">#FFC5CBF9</Color>
            <Color x:Key="ContentAreaColorDark">#FF343435</Color>
            <Color x:Key="DisabledControlLightColor">#FFE8EDF9</Color>
            <Color x:Key="DisabledControlDarkColor">#FFC5CBF9</Color>
            <Color x:Key="DisabledForegroundColor">#FF888888</Color>
            <Color x:Key="SelectedBackgroundColor">#FFC5CBF9</Color>
            <Color x:Key="SelectedUnfocusedColor">#FFDDDDDD</Color>
            <Color x:Key="ControlLightColor">White</Color>
            <Color x:Key="ControlMediumColor">#FF444445</Color>
            <Color x:Key="ControlDarkColor">#FF211AA9</Color>
            <Color x:Key="ControlMouseOverColor">#FF242426</Color>
            <Color x:Key="ControlPressedColor">#FF444445</Color>
            <Color x:Key="GlyphColor">#FF202020</Color>
            <Color x:Key="GlyphMouseOver">sc#1, 0.004391443, 0.002428215, 0.242281124</Color>
            <Color x:Key="BorderLightColor">#FFCCCCCC</Color>
            <Color x:Key="BorderMediumColor">#FF888888</Color>
            <Color x:Key="BorderDarkColor">#FF444444</Color>
            <Color x:Key="PressedBorderLightColor">#FF888888</Color>
            <Color x:Key="PressedBorderDarkColor">#FF444444</Color>
            <Color x:Key="DisabledBorderLightColor">#FFAAAAAA</Color>
            <Color x:Key="DisabledBorderDarkColor">#FF888888</Color>
            <Color x:Key="DefaultBorderBrushDarkColor">Black</Color>
            <LinearGradientBrush x:Key="NormalDarkBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#555" />
                        <GradientStop Offset="1.0" Color="#222" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="NormalBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#DDD" />
                        <GradientStop Offset="1.0" Color="#666" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="NormalBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#FFF" />
                        <GradientStop Offset="1.0" Color="#BBB" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="KeyboardFocusedBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#DDD" />
                        <GradientStop Offset="1.0" Color="#000" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="DefaultedBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#777" />
                        <GradientStop Offset="1.0" Color="#000" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="DarkBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#FFF" />
                        <GradientStop Offset="1.0" Color="#999" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="ExtraDarkBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#444" />
                        <GradientStop Offset="1.0" Color="#111" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="PressedBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#BBB" />
                        <GradientStop Offset="0.1" Color="#EEE" />
                        <GradientStop Offset="0.9" Color="#EEE" />
                        <GradientStop Offset="1.0" Color="#FFF" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="PressedBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#444" />
                        <GradientStop Offset="1.0" Color="#888" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="ProgressBrushLinear" StartPoint="0,0" EndPoint="0,1">
                <GradientBrush.GradientStops>
                    <GradientStopCollection>
                        <GradientStop Offset="0.0" Color="#F5F5F5" />
                        <GradientStop Offset="0.5" Color="DodgerBlue" />
                        <GradientStop Offset="1.0" Color="Navy" />
                    </GradientStopCollection>
                </GradientBrush.GradientStops>
            </LinearGradientBrush>
            <RadialGradientBrush x:Key="SnowBrushRadial" GradientOrigin="0.75,0.25">
                <RadialGradientBrush.GradientStops>
                    <GradientStop Offset="0.0" Color="White" />
                    <GradientStop Offset="0.6" Color="#C0C0C0" />
                    <GradientStop Offset="1.0" Color="#222222" />
                </RadialGradientBrush.GradientStops>
            </RadialGradientBrush>
            <RadialGradientBrush x:Key="WindBrushRadial" GradientOrigin="0.75,0.25">
                <RadialGradientBrush.GradientStops>
                    <GradientStop Offset="0.0" Color="#82FFFFFF" />
                    <GradientStop Offset="0.6" Color="#821E90FF" />
                    <GradientStop Offset="1.0" Color="#82222222" />
                </RadialGradientBrush.GradientStops>
            </RadialGradientBrush>
            <LinearGradientBrush x:Key="updateViewBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0.0" Color="#FF3F3F3F" />
                <GradientStop Offset="0.5" Color="#FF2F2F2F" />
                <GradientStop Offset="1.0" Color="#FF343434" />
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="statusBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0.0" Color="#FF1A1A1F" />
                <GradientStop Offset="0.5" Color="#FF12121A" />
                <GradientStop Offset="1.0" Color="#FF252528" />
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="brightBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0.0" Color="#FFEEEEEE" />
                <GradientStop Offset="0.5" Color="#FFFFFFFF" />
                <GradientStop Offset="1.0" Color="#FFDDDDDD" />
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="SolidBorderBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0.0" Color="#FF1A1A1F" />
                <GradientStop Offset="0.5" Color="#FF12121A" />
                <GradientStop Offset="1.0" Color="#FF252528" />
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="rbHorzBrush" StartPoint="0,0.5" EndPoint="1,0.5">
                <GradientStop Offset="0.0" Color="#AAFFFF00" />
                <GradientStop Offset="0.25" Color="#AAFF0000" />
                <GradientStop Offset="0.75" Color="#AA0000FF" />
                <GradientStop Offset="1.0" Color="#AA00FF00" />
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="rbVertBrush" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Offset="0.0" Color="#AAFFFF00" />
                <GradientStop Offset="0.25" Color="#AAFF0000" />
                <GradientStop Offset="0.75" Color="#AA0000FF" />
                <GradientStop Offset="1.0" Color="#AA00FF00" />
            </LinearGradientBrush>
            <!--#endregion-->

            <!--  Button styler  -->
            <ControlTemplate x:Key="ReformedButton" TargetType="{x:Type Button}">
                <Grid>
                    <!--#region [glow effect around button]-->
                    <!--
                    <ctrl:GlowDecorator
                        Margin="5,3,5,3"
                        BlurRadius="14"
                        CornerRadius="4"
                        PenThickness="2"
                        Color="{StaticResource GlowLight}" />
                    -->
                    <!--#endregion-->
                    <Border
                        x:Name="Border"
                        MinHeight="20"
                        Margin="{TemplateBinding Margin}"
                        Padding="{TemplateBinding Padding}"
                        Background="{StaticResource NormalDarkBrush}"
                        BorderBrush="{StaticResource NormalBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                        <TextBlock
                            x:Name="Text"
                            Margin="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{StaticResource NormalBrush}"
                            Text="{TemplateBinding Content}"
                            TextOptions.TextFormattingMode="Display"
                            TextOptions.TextRenderingMode="ClearType">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="1"
                                    Direction="310"
                                    Opacity="1"
                                    ShadowDepth="0.5"
                                    Color="{StaticResource BackgroundLight}" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="3"
                                Direction="310"
                                Opacity="0.6"
                                ShadowDepth="3"
                                Color="{StaticResource BackgroundDark}" />
                        </Border.Effect>
                    </Border>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsKeyboardFocused" Value="True">
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource KeyboardFocusedBorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsDefaulted" Value="true">
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DefaultedBorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource ExtraDarkBrush}" />
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource PressedBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource PressedBorderBrush}" />
                        <Setter TargetName="Border" Property="Effect" Value="{x:Null}" />
                        <Setter TargetName="Text" Property="Effect">
                            <Setter.Value>
                                <DropShadowEffect
                                    BlurRadius="2"
                                    Direction="130"
                                    Opacity="0.7"
                                    ShadowDepth="1"
                                    Color="{StaticResource BackgroundDark}" />
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource DisabledBackgroundBrush2}" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DisabledBorderBrush}" />
                        <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}" />
                        <Setter TargetName="Text" Property="Foreground" Value="{StaticResource PressedBorderBrush}" />
                        <Setter TargetName="Border" Property="Effect" Value="{x:Null}" />
                        <Setter TargetName="Text" Property="Effect">
                            <Setter.Value>
                                <DropShadowEffect
                                    BlurRadius="3"
                                    Direction="130"
                                    Opacity="0.5"
                                    ShadowDepth="1"
                                    Color="{StaticResource BackgroundDark}" />
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>

            <!--
                https://docs.microsoft.com/en-us/dotnet/desktop/wpf/graphics-multimedia/animation-and-timing-how-to-topics?view=netframeworkdesktop-4.8
            -->
            <!--  TextBlock fade-in/fade-out Styling  -->
            <Style x:Key="fadeInOut" TargetType="{x:Type TextBlock}">
                <Style.Triggers>
                    <EventTrigger RoutedEvent="Binding.TargetUpdated">
                        <!--  this did not work  -->
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation
                                    BeginTime="0:0:0"
                                    SpeedRatio="2.0"
                                    Storyboard.TargetProperty="(TextBlock.Opacity)"
                                    From="0.0"
                                    To="1.0"
                                    Duration="0:0:3" />
                                <DoubleAnimation
                                    BeginTime="0:0:0"
                                    SpeedRatio="0.5"
                                    Storyboard.TargetProperty="(TextBlock.Opacity)"
                                    From="1.0"
                                    To="0.0"
                                    Duration="0:0:3" />
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="textFade" TargetType="{x:Type TextBlock}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Path=DataPulse}" Value="True">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation
                                        AutoReverse="True"
                                        Storyboard.TargetProperty="(TextBlock.Opacity)"
                                        From="0.0"
                                        To="1.0"
                                        Duration="0:0:1.5" />
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <!--
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation
                                        Storyboard.TargetProperty="(TextBlock.Opacity)"
                                        From="1.0"
                                        To="0.0"
                                        Duration="0:0:3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                        -->
                    </DataTrigger>
                    <!--
                    <DataTrigger Binding="{Binding Path=DataPulse}" Value="False">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation
                                        Storyboard.TargetProperty="(TextBlock.Opacity)"
                                        From="1.0"
                                        To="0.0"
                                        Duration="0:0:3" />
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>
                    -->
                </Style.Triggers>
            </Style>

            <!--  ComboBox Styling Extras  -->
            <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="{x:Type ToggleButton}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="20" />
                    </Grid.ColumnDefinitions>
                    <Border
                        x:Name="Border"
                        Grid.ColumnSpan="2"
                        Background="#FF3F3F3F"
                        BorderBrush="#FF97A0A5"
                        BorderThickness="1"
                        CornerRadius="0" />
                    <Border
                        Grid.Column="0"
                        Margin="1"
                        Background="#FF3F3F3F"
                        BorderBrush="#FF97A0A5"
                        BorderThickness="0,0,1,0"
                        CornerRadius="0" />
                    <Path
                        x:Name="Arrow"
                        Grid.Column="1"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Data="M0,0 L0,2 L4,6 L8,2 L8,0 L4,4 z"
                        Fill="White" />
                </Grid>
                <!--
                <ControlTemplate.Triggers>
                    <Trigger Property="ToggleButton.IsMouseOver" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="#808080" />
                    </Trigger>
                    <Trigger Property="ToggleButton.IsChecked" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="#E0E0E0" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter TargetName="Border" Property="Background" Value="#EEEEEE" />
                        <Setter TargetName="Border" Property="BorderBrush" Value="#AAAAAA" />
                        <Setter Property="Foreground" Value="#888888"/>
                        <Setter TargetName="Arrow" Property="Fill" Value="#888888" />
                    </Trigger>
                </ControlTemplate.Triggers>
                -->
            </ControlTemplate>
            <ControlTemplate x:Key="ComboBoxTextBox" TargetType="{x:Type TextBox}">
                <Border
                    x:Name="PART_ContentHost"
                    Background="{TemplateBinding Background}"
                    Focusable="False" />
            </ControlTemplate>
            <!--  New ComboBox Styling  -->
            <Style x:Key="TransparentComboBoxStyle" TargetType="ComboBox">
                <Setter Property="SnapsToDevicePixels" Value="true" />
                <Setter Property="OverridesDefaultStyle" Value="true" />
                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
                <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
                <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
                <Setter Property="MinWidth" Value="120" />
                <Setter Property="MinHeight" Value="20" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBox">
                            <Grid>
                                <ToggleButton
                                    Name="ToggleButton"
                                    Grid.Column="2"
                                    ClickMode="Press"
                                    Focusable="false"
                                    IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                    Template="{StaticResource ComboBoxToggleButton}" />
                                <ContentPresenter
                                    Name="ContentSite"
                                    Margin="15,6,22,3"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Content="{TemplateBinding SelectionBoxItem}"
                                    ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                    ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                    IsHitTestVisible="False" />
                                <TextBox
                                    x:Name="PART_EditableTextBox"
                                    Margin="3,3,23,3"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    Focusable="True"
                                    IsReadOnly="{TemplateBinding IsReadOnly}"
                                    Style="{x:Null}"
                                    Template="{StaticResource ComboBoxTextBox}"
                                    Visibility="Hidden" />
                                <Popup
                                    Name="Popup"
                                    Margin="0,0,0,0"
                                    AllowsTransparency="True"
                                    Focusable="False"
                                    IsOpen="{TemplateBinding IsDropDownOpen}"
                                    Opacity="1"
                                    OpacityMask="#FF000000"
                                    Placement="Bottom"
                                    PopupAnimation="Fade"
                                    VerticalOffset="1">
                                    <Grid
                                        Name="DropDown"
                                        MinWidth="{TemplateBinding ActualWidth}"
                                        MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                        Margin="0,0,20,20"
                                        ShowGridLines="False"
                                        SnapsToDevicePixels="True">
                                        <Border
                                            x:Name="DropDownBorder"
                                            Grid.RowSpan="1"
                                            Grid.ColumnSpan="3"
                                            Padding="0,0,0,0"
                                            AllowDrop="True"
                                            Background="{DynamicResource LightBrush}"
                                            BorderBrush="{StaticResource SolidBorderBrush}"
                                            BorderThickness="2,2,2,2"
                                            CornerRadius="4,4,4,4"
                                            IsEnabled="True"
                                            OverridesDefaultStyle="False">
                                            <Border.BitmapEffect>
                                                <DropShadowBitmapEffect
                                                    Noise="-1"
                                                    ShadowDepth="20"
                                                    Softness="3.5" />
                                            </Border.BitmapEffect>
                                        </Border>
                                        <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                        </ScrollViewer>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="HasItems" Value="false">
                                    <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}" />
                                </Trigger>
                                <Trigger Property="IsGrouping" Value="true">
                                    <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
                                </Trigger>
                                <Trigger SourceName="Popup" Property="Popup.AllowsTransparency" Value="true">
                                    <Setter TargetName="DropDownBorder" Property="CornerRadius" Value="4" />
                                    <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0" />
                                </Trigger>
                                <Trigger Property="IsEditable" Value="true">
                                    <Setter Property="IsTabStop" Value="false" />
                                    <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                                    <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers />
            </Style>
            <Style x:Key="{x:Type ComboBox}" TargetType="{x:Type ComboBox}">
                <Setter Property="SnapsToDevicePixels" Value="true" />
                <Setter Property="OverridesDefaultStyle" Value="true" />
                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
                <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
                <Setter Property="ScrollViewer.CanContentScroll" Value="true" />
                <Setter Property="MinWidth" Value="120" />
                <Setter Property="MinHeight" Value="20" />
                <Setter Property="Foreground" Value="White" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ComboBox}">
                            <Grid>
                                <ToggleButton
                                    Name="ToggleButton"
                                    Grid.Column="2"
                                    ClickMode="Press"
                                    Focusable="false"
                                    IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                    Template="{StaticResource ComboBoxToggleButton}" />
                                <ContentPresenter
                                    Name="ContentSite"
                                    Margin="3,3,23,3"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Content="{TemplateBinding SelectionBoxItem}"
                                    ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                    ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                    IsHitTestVisible="False" />
                                <TextBox
                                    x:Name="PART_EditableTextBox"
                                    Margin="3,3,23,3"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Background="#FF3F3F3F"
                                    Focusable="True"
                                    Foreground="Green"
                                    IsReadOnly="{TemplateBinding IsReadOnly}"
                                    Style="{x:Null}"
                                    Template="{StaticResource ComboBoxTextBox}"
                                    Visibility="Hidden" />
                                <Popup
                                    Name="Popup"
                                    AllowsTransparency="True"
                                    Focusable="False"
                                    IsOpen="{TemplateBinding IsDropDownOpen}"
                                    Placement="Bottom"
                                    PopupAnimation="Slide">

                                    <Grid
                                        Name="DropDown"
                                        MinWidth="{TemplateBinding ActualWidth}"
                                        MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                        SnapsToDevicePixels="True">
                                        <Border
                                            x:Name="DropDownBorder"
                                            Background="#FF3F3F3F"
                                            BorderBrush="#888888"
                                            BorderThickness="1" />
                                        <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                        </ScrollViewer>
                                    </Grid>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="HasItems" Value="false">
                                    <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="#888888" />
                                </Trigger>
                                <Trigger Property="IsGrouping" Value="true">
                                    <Setter Property="ScrollViewer.CanContentScroll" Value="false" />
                                </Trigger>
                                <Trigger SourceName="Popup" Property="Popup.AllowsTransparency" Value="true">
                                    <Setter TargetName="DropDownBorder" Property="CornerRadius" Value="0" />
                                    <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0" />
                                </Trigger>
                                <Trigger Property="IsEditable" Value="true">
                                    <Setter Property="IsTabStop" Value="false" />
                                    <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible" />
                                    <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers />
            </Style>

            <!--  SimpleStyles: ComboBoxItem  -->
            <Style x:Key="{x:Type ComboBoxItem}" TargetType="{x:Type ComboBoxItem}">
                <Setter Property="SnapsToDevicePixels" Value="true" />
                <Setter Property="Foreground" Value="White" />
                <Setter Property="OverridesDefaultStyle" Value="true" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                            <Border
                                Name="Border"
                                Padding="2"
                                SnapsToDevicePixels="true">
                                <ContentPresenter />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsHighlighted" Value="true">
                                    <Setter TargetName="Border" Property="Background" Value="#FF4F4F4F" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="#888888" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!--  Style any slider controls  -->
            <Style TargetType="{x:Type Slider}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Slider}">
                            <Grid VerticalAlignment="Center">
                                <Border
                                    x:Name="borderBackground"
                                    Height="4"
                                    Margin="6,0"
                                    Background="Gray" />
                                <Canvas Margin="0,-4,0,0" VerticalAlignment="Center">
                                    <Border
                                        x:Name="PART_SelectionRange"
                                        Height="4"
                                        HorizontalAlignment="Left"
                                        Background="{TemplateBinding Foreground}" />
                                </Canvas>
                                <Track x:Name="PART_Track">
                                    <Track.Thumb>
                                        <Thumb Width="10" Height="20" />
                                    </Track.Thumb>
                                </Track>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="IsSelectionRangeEnabled" Value="True" />
                <Setter Property="SelectionStart" Value="{Binding Minimum, RelativeSource={RelativeSource Self}}" />
                <Setter Property="SelectionEnd" Value="{Binding Value, RelativeSource={RelativeSource Self}}" />
                <Setter Property="Foreground" Value="DarkBlue" />
                <!-- OTHER PROPERTIES TO EXPERIMENT WITH...
                <SolidColorBrush x:Key="SliderSelectionBackground" Color="Green" />
                <SolidColorBrush x:Key="SliderSelectionBorder" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBackground" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBackgroundDisabled" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBackgroundDragging" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBackgroundHover" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBorder" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBorderDisabled" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBorderDragging" Color="Green" />
                <SolidColorBrush x:Key="SliderThumbBorderHover" Color="Green" />
                -->
            </Style>

            <!--#region [Expander Styler]-->
            <SolidColorBrush x:Key="GroupBoxBorderBrush" Color="#D0D0BF" />
            <SolidColorBrush x:Key="GroupBoxHeaderBrush" Color="DodgerBlue" />
            <BorderGapMaskConverter x:Key="BorderGapMaskConverter" />
            <Style x:Key="GroupBoxExpanderToggleButtonStyle" TargetType="{x:Type ToggleButton}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                <!--  shown on mouse out  -->
                                <Ellipse
                                    x:Name="circle"
                                    Width="24"
                                    Height="24"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{StaticResource NormalDarkBrush}"
                                    Stroke="DarkGray"
                                    StrokeEndLineCap="Round"
                                    StrokeStartLineCap="Round" />
                                <!--  shown on mouse in  -->
                                <Ellipse
                                    x:Name="shadow"
                                    Width="22"
                                    Height="22"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{StaticResource NormalBrush}"
                                    StrokeEndLineCap="Round"
                                    StrokeStartLineCap="Round"
                                    Visibility="Hidden" />
                                <!--  chevron down  -->
                                <Path
                                    x:Name="arrow"
                                    Margin="-1,1,0,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M 2,2 L 8,8 L 14,2"
                                    RenderTransformOrigin="0.5,0.5"
                                    SnapsToDevicePixels="false"
                                    Stroke="{StaticResource NormalBrush}"
                                    StrokeEndLineCap="Round"
                                    StrokeStartLineCap="Round"
                                    StrokeThickness="2">
                                    <Path.RenderTransform>
                                        <RotateTransform x:Name="ChevronRotate" Angle="0" CenterX="0" CenterY="0" />
                                    </Path.RenderTransform>
                                </Path>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="arrow" Property="Margin" Value="-1,-1,0,0" />
                                    <!--  swap path data for chevron  -->
                                    <Setter TargetName="arrow" Property="Data" Value="M 2,8 L 8,2 L 14,8" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="circle" Property="Stroke" Value="#666" />
                                    <Setter TargetName="arrow" Property="Stroke" Value="#222" />
                                    <Setter TargetName="shadow" Property="Visibility" Value="Visible" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="GroupBoxExpander" TargetType="{x:Type Expander}">
                <Setter Property="BorderBrush" Value="{StaticResource GroupBoxBorderBrush}" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Expander}">
                            <Grid SnapsToDevicePixels="true">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="6" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="6" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="6" />
                                </Grid.RowDefinitions>
                                <Border
                                    Grid.Row="1"
                                    Grid.RowSpan="3"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="4"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="Transparent"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4" />
                                <Border
                                    x:Name="Header"
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="1"
                                    Padding="3,0,3,0">
                                    <Grid
                                        Grid.Row="0"
                                        Grid.RowSpan="2"
                                        Grid.Column="1"
                                        Background="Transparent"
                                        SnapsToDevicePixels="False">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <ctrl:GlowDecorator
                                            Grid.Column="0"
                                            Margin="4"
                                            BlurRadius="12"
                                            CornerRadius="8"
                                            PenThickness="2"
                                            Color="{StaticResource GlowLight}" />
                                        <ToggleButton
                                            Name="HeaderToggle"
                                            Grid.Column="0"
                                            MinWidth="0"
                                            MinHeight="0"
                                            IsChecked="{Binding Path=IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                            Style="{StaticResource GroupBoxExpanderToggleButtonStyle}" />
                                        <ContentPresenter
                                            Grid.Column="1"
                                            Margin="4,3,0,0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            ContentSource="Header"
                                            RecognizesAccessKey="true"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                            TextElement.Foreground="{StaticResource NormalBrush}" />
                                    </Grid>
                                </Border>
                                <ContentPresenter
                                    x:Name="ExpandSite"
                                    Grid.Row="2"
                                    Grid.Column="1"
                                    Grid.ColumnSpan="2"
                                    Margin="{TemplateBinding Padding}"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                    Visibility="Collapsed" />
                                <Border
                                    Grid.Row="1"
                                    Grid.RowSpan="3"
                                    Grid.ColumnSpan="4"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4">
                                    <Border.OpacityMask>
                                        <MultiBinding Converter="{StaticResource BorderGapMaskConverter}" ConverterParameter="7">
                                            <Binding ElementName="Header" Path="ActualWidth" />
                                            <Binding Path="ActualWidth" RelativeSource="{RelativeSource Self}" />
                                            <Binding Path="ActualHeight" RelativeSource="{RelativeSource Self}" />
                                        </MultiBinding>
                                    </Border.OpacityMask>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsExpanded" Value="true">
                                    <Setter TargetName="ExpandSite" Property="Visibility" Value="Visible" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="false">
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                </Trigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <!--#endregion-->

        </ResourceDictionary>
    </Application.Resources>
</Application>
